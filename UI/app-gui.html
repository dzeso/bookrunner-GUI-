<style>
</style>

<script type="text/x-template" id="gui-template"> 
  <v-app id="bookraner" dark>
    <app-navigation-drawer :isVisible="drawer" :menu="drawerList"></app-navigation-drawer>
    
    <v-toolbar app fixed clipped-left>
      <v-toolbar-side-icon @click.stop="drawer = !drawer"></v-toolbar-side-icon>
      <v-toolbar-title>Bookrunner</v-toolbar-title>
      <v-spacer></v-spacer>
      <menu-more-vert :items="menu" @menuMoreVertAction="doAction"></menu-more-vert>
    </v-toolbar>
    
    <v-content>
      <v-container fluid>
        <v-fade-transition mode="out-in">
          <keep-alive>
            <router-view></router-view>
          </keep-alive>
        </v-fade-transition>
      </v-container>
    </v-content>
    
    <v-footer app class="pa-3">
      <v-spacer></v-spacer>
      <div>© {{ new Date().getFullYear() }}</div>
    </v-footer>
  </v-app>
</script>

<script>
  var gui = {
    template: "#gui-template",
    components: {
      AppNavigationDrawer: AppNavigationDrawer,
      MenuMoreVert: MenuMoreVert,
      },
    created () {
      this.$store.dispatch('initDomData');
    },
    mounted () {
      this.queryAndIndeterminate();
      },
    beforeDestroy () {
      clearInterval(this.interval);
      },
    data: () => ({
      drawer: true,
      interval: 0,
      delay: 10,
      menu: [
          {name: "Запустить имитацию торгов", mode: "start_generation"}, 
          {name: "Остановить имитацию", mode: "stop_generation"}
        ],
      drawerList: [
        { 
          icon: "keyboard_arrow_up",
          iconAlt: "keyboard_arrow_down",
          text: "Карточки",
          model: true,
          children: [
            { icon: "desktop_windows", text: "V1.1", link: "/view/card/v1_1" },
            { icon: "desktop_windows", text: "V.1.2 (Замечания Ильи)", link: "/view/card/v1_2" },
            { icon: "desktop_windows", text: "V.2.1 (без тулбара)", link: "/view_v2/card/v2_1" },
            { icon: "tablet_android", text: "Планшет", link: "" },
            { icon: "smartphone", text: "Смартфон", link: "" }
          ]
        },
        { icon: "view_list", text: "Список", link: "/view/list/v3_1" },
        { icon: "table_chart", text: "Таблица", link: "/review/list" },
        { icon: "view_week", text: "Стаканы", link: "/news/list/all" },
        { icon: "insert_chart", text: "Графики", link: "/view/charts" },
        ]
      }),
    computed: {
      },
    methods: {
    
      doAction(item) {
        if (item.mode == "start_generation") this.queryAndIndeterminate();
        else if (item.mode == "stop_generation") clearInterval(this.interval);
        },        
        
      queryAndIndeterminate () {
        this.interval = setInterval(() => {
          this.$store.dispatch('generateFakeDomData');
          }, this.delay)
        },  
      },
  }
console.log ("app-gui started");  
</script>

